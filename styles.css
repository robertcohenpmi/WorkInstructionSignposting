/* ---------- THEME TOKENS ---------- */
/* Light (default) */
:root{
  --bg:#ffffff; --ink:#0f172a; --muted:#475569; --panel:#f8fafc; --border:#e2e8f0;
  --accent:#0369a1; --accent-bg:#e0f2fe; --chip:#eef2f7; --chip-border:#d8dee9;
  --wi:#1d4ed8; --cs:#b45309; --shadow:0 6px 24px rgba(0,0,0,.08);
}
/* Dark */
html[data-theme="dark"]{
  --bg:#0b0f14; --ink:#e8eef5; --muted:#9bb0c9; --panel:#121821; --border:#202938;
  --accent:#7dd3fc; --accent-bg:#0b1b24; --chip:#1c2431; --chip-border:#2a3444;
  --wi:#93c5fd; --cs:#fbbf24; --shadow:0 8px 30px rgba(0,0,0,.25);
}

*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;font-family:Segoe UI,Inter,system-ui,Roboto,Arial,sans-serif;background:var(--bg);color:var(--ink)}
.container{max-width:1200px;margin:auto;padding:20px}

/* Header */
header{display:flex;flex-direction:column;gap:10px;margin-bottom:8px}
.topbar{display:flex;gap:12px;align-items:center;justify-content:space-between}
.brand{display:flex;gap:10px;align-items:center}
.brand h1{margin:0;font-size:20px}
.brand small{color:var(--muted)}

/* Theme button */
.theme-btn{background:var(--panel);border:1px solid var(--border);border-radius:10px;padding:8px 12px;color:var(--ink);cursor:pointer;display:inline-flex;align-items:center;gap:6px}
.theme-btn:hover{box-shadow:var(--shadow)}

/* Controls row */
.controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
.search{display:flex;gap:8px;align-items:center;background:var(--panel);border:1px solid var(--border);border-radius:10px;padding:8px 12px}
.search input{flex:1;background:transparent;border:0;outline:none;color:var(--ink);font-size:16px;min-width:220px}
.select, .btn{background:var(--panel);border:1px solid var(--border);border-radius:10px;padding:8px 10px;color:var(--ink)}
.btn{cursor:pointer}
.clear-btn{background:transparent;border-color:var(--border)}
.clear-btn:hover{background:var(--panel);box-shadow:var(--shadow)}

/* Audience multiselect */
.select{position:relative}
.select>button{display:flex;align-items:center;gap:8px;background:transparent;border:0;color:var(--ink);cursor:pointer}
.menu{position:absolute;z-index:5;top:110%;left:0;background:var(--bg);border:1px solid var(--border);border-radius:10px;box-shadow:var(--shadow);padding:8px;min-width:280px;max-height:320px;overflow:auto;display:none}
.select.open .menu{display:block}
.menu .hdr{display:flex;gap:6px;align-items:center;padding:4px 6px}
.menu .hdr input{flex:1;background:var(--panel);border:1px solid var(--border);border-radius:8px;padding:6px 8px;color:var(--ink)}
.menu .row{display:flex;gap:8px;align-items:center;padding:6px;border-radius:8px}
.menu .row:hover{background:var(--panel)}
.menu .row .count{margin-left:auto;color:var(--muted);font-size:12px}
.counter{color:var(--muted);font-size:12px}
.menu .actions{display:flex;justify-content:space-between;gap:6px;padding:4px 6px}
.menu .actions button{border:1px solid var(--border);background:var(--panel);border-radius:8px;padding:6px 8px;cursor:pointer}

/* Chips */
.chips{display:flex;flex-wrap:wrap;gap:6px;margin-top:8px}
.chip{display:inline-flex;align-items:center;gap:6px;background:var(--chip);border:1px solid var(--chip-border);color:var(--ink);border-radius:999px;padding:4px 8px;font-size:12px}
.chip .x{background:transparent;border:0;color:var(--muted);cursor:pointer;padding:0 4px;border-radius:6px;line-height:1}
.chip .x:hover{background:var(--panel)}
.chip--clear{background:transparent;border-style:dashed;color:var(--muted);cursor:pointer}

/* Layout: sidebar + main */
.layout{display:grid;grid-template-columns:260px 1fr;gap:16px;margin-top:6px}
.sidebar{background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:10px;position:sticky;top:10px;align-self:start;max-height:calc(100vh - 40px);overflow:auto}
.sidebar h2{margin:4px 8px 8px;font-size:14px;color:var(--muted)}
.groups{display:flex;flex-direction:column;gap:2px}
.group-item{display:flex;gap:8px;align-items:center;padding:8px;border-radius:8px;cursor:pointer}
.group-item .name{flex:1;min-width:0}
.group-item .count{color:var(--muted);font-size:12px}
.group-item:hover{background:var(--bg)}
.group-item.active{background:var(--accent-bg);border:1px solid var(--border)}
.group-item .name, .section-title{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}

/* Cards */
.section{margin-bottom:20px}
.section-title{font-size:14px;color:var(--muted);padding:8px 2px;border-bottom:1px solid var(--border);margin-bottom:8px}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:10px}
.card{background:var(--bg);border:1px solid var(--border);border-radius:12px;padding:12px;display:flex;flex-direction:column;gap:8px}
.card h3{margin:0;font-size:16px}
.card a{color:var(--accent);text-decoration:none}
.meta{display:flex;gap:8px;flex-wrap:wrap}
.badge{display:inline-flex;align-items:center;gap:6px;background:var(--chip);border:1px solid var(--chip-border);padding:2px 8px;border-radius:999px;font-size:12px;color:var(--muted)}
.type-wi{color:var(--wi);border-color:#c7d2fe;background:color-mix(in oklab, var(--wi) 12%, transparent)}
html[data-theme="dark"] .type-wi{border-color:#334155;background:rgba(125,211,252,.12)}
.type-cs{color:var(--cs);border-color:#fcd34d;background:#fffbeb}
html[data-theme="dark"] .type-cs{border-color:#3a2d11;background:rgba(250,204,21,.12)}
.helper{color:var(--muted);font-size:12px}

/* Card actions (Copy Link) */
.card-actions{display:flex;gap:8px;margin-top:4px}
.card-actions .btn-sm{border:1px solid var(--border);background:var(--panel);color:var(--ink);border-radius:8px;padding:6px 8px;font-size:12px;cursor:pointer}
.card-actions .btn-sm:hover{box-shadow:var(--shadow)}

/* Count & status */
.count{color:var(--muted);margin:6px 0}
.status{margin:10px 0;padding:10px;border:1px dashed var(--border);border-radius:10px;color:var(--muted)}

/* Highlight */
mark{background:color-mix(in oklab, var(--accent) 18%, transparent);color:inherit;padding:0 .1em;border-radius:3px}

/* SR-only */
.visually-hidden{
  position:absolute !important; clip:rect(1px,1px,1px,1px); clip-path: inset(50%);
  height:1px; width:1px; overflow:hidden; white-space:nowrap; border:0; padding:0; margin:-1px;
}

/* Responsive */
@media(max-width:1024px){
  .layout{grid-template-columns:1fr}
  .sidebar{position:static;max-height:none}
}
@media(max-width:640px){
  .controls{justify-content:flex-start}
